#!/usr/bin/env bash
set -euo pipefail
echo "üîé Pre-push: ejecutando TypeScript y Lint‚Ä¶"

# Permitir saltar typecheck con variable de entorno
if [ "${AIDUX_SKIP_TYPECHECK:-0}" = "1" ]; then
  echo "‚è≠Ô∏è  Typecheck saltado por AIDUX_SKIP_TYPECHECK=1"
else
  npm run -s typecheck || { echo "‚ùå TypeScript fall√≥"; exit 1; }
fi

# Lint (si hay override, √∫salo)
if [ -f "./eslint.override.config.js" ]; then
  npx eslint --config eslint.override.config.js "src/**/*.{ts,tsx}" --quiet || { echo "‚ùå ESLint fall√≥"; exit 1; }
else
  npx eslint "src/**/*.{ts,tsx}" --quiet || { echo "‚ùå ESLint fall√≥"; exit 1; }
fi

echo "‚úÖ Pre-push OK"
