🚀 INICIANDO SCRIPT DE VALIDACIÓN BACKEND
📅 Fecha: 2025-07-17T06:14:43.912Z

🔍 VALIDANDO CONECTIVIDAD CON EL CEREBRO CLÍNICO...
   - Endpoint accesible: SÍ
   - CORS habilitado: SÍ
   - Métodos permitidos: GET, POST, OPTIONS

🏥 INICIANDO PROTOCOLO DE VALIDACIÓN BACKEND END-TO-END
================================================================================
🎯 Objetivo: Validar el 'Cerebro Clínico' con casos de prueba reales
🔗 Endpoint: https://us-east1-aiduxcare-stt-20250706.cloudfunctions.net/clinicalBrain
📊 Casos de prueba: 2
================================================================================

🧪 EJECUTANDO Caso 1: Lumbalgia Mecánica Simple
------------------------------------------------------------
📤 Enviando petición al Cerebro Clínico...
📋 Datos enviados: {
  "transcription": "Paciente refiere dolor lumbar en la zona derecha desde hace una semana después de levantar peso. El dolor aumenta con la flexión y se alivia con el reposo.",
  "specialty": "physiotherapy",
  "sessionType": "initial"
}

⏱️ Tiempo de respuesta - Caso 1: Lumbalgia Mecánica Simple: 40.582s
⏱️ Tiempo total de procesamiento: 40581ms

✅ RESPUESTA EXITOSA DEL CEREBRO CLÍNICO
📊 Respuesta JSON completa y sin procesar:
{
  "warnings": [],
  "suggestions": [],
  "soap_quality": {
    "subjective": 70,
    "objective": 65,
    "assessment": 70,
    "plan": 70,
    "overall": 69
  },
  "soap_note": {},
  "functional_goals": [],
  "treatment_techniques": [],
  "analysis_metadata": {
    "red_flags_detected": 0,
    "risk_level": "LOW",
    "confidence": 0,
    "clinical_facts_extracted": 2,
    "processing_stages": 3
  },
  "success": true,
  "metadata": {
    "processingTime": 40.347,
    "modelUsed": "cascade-v2",
    "totalTime": 40.348,
    "timestamp": "2025-07-17T06:15:24.928Z",
    "version": "2.0-optimized"
  }
}

🔍 ANÁLISIS DE LA RESPUESTA:
   - Status HTTP: 200
   - Content-Type: application/json; charset=utf-8
   - Tamaño respuesta: 473 caracteres
   - Warnings detectados: 0
✅ CASO EXITOSO

================================================================================

🧪 EJECUTANDO Caso 2: Cuadro Complejo con Banderas Rojas (Nuestro caso de prueba maestro)
------------------------------------------------------------
📤 Enviando petición al Cerebro Clínico...
📋 Datos enviados: {
  "transcription": "Hola Doctor hoy estoy muy adolorida de mi espalda esto no es nuevo me levanto cada mañana con mucho dolor en la parte baja de mi espalda y que a veces no me permite caminar incluso quedo como girada esto me viene pasando hace un tiempo y es mucho más molesto durante la mañana me cuesta partir incluso me cuesta salir de la cama y mi doctora sospecha de qué puede estar relacion con una posible celiaquía que tengo un estudio durante mucho tiempo me trataron como que fuera una enfermedad de artritis reumática sin embargo al parecer tengo un tema inmunológico también estoy deprimida y me están dando algunos medicamentos para la depresión trato de hacer ejercicio pero no puedo ser constante y no sé qué debo hacer me siento muy cansada constantemente y en el último examen de sangre me encontraron que el hierro estaba muy bajo y cuando estoy con mucho dolor estomacal porque he comido algo con gluten suelo tomar nolotil y paracetamol",
  "specialty": "physiotherapy",
  "sessionType": "initial"
}

⏱️ Tiempo de respuesta - Caso 2: Cuadro Complejo con Banderas Rojas (Nuestro caso de prueba maestro): 1:37.293 (m:ss.mmm)
⏱️ Tiempo total de procesamiento: 97290ms

✅ RESPUESTA EXITOSA DEL CEREBRO CLÍNICO
📊 Respuesta JSON completa y sin procesar:
{
  "warnings": [
    {
      "severity": "HIGH",
      "category": "red_flag",
      "title": "Sospecha de dolor lumbar inflamatorio",
      "description": "La paciente refiere dolor lumbar crónico, mucho más molesto por la mañana, con rigidez que le dificulta salir de la cama y 'partir' el día. Este patrón es altamente sugestivo de dolor inflamatorio (ej. espondiloartropatía), que a menudo se asocia con dolor nocturno que no cede con el reposo y mejora con la actividad.",
      "action": "Derivación médica urgente a reumatología o especialista en medicina interna para evaluación diagnóstica y manejo de una posible enfermedad inflamatoria sistémica. La fisioterapia debe ser cautelosa y coordinada con el tratamiento médico."
    },
    {
      "severity": "HIGH",
      "category": "red_flag|contraindication|referral",
      "title": "Dolor musculoesquelético asociado a enfermedad sistémica no diagnosticada/controlada",
      "description": "La paciente presenta dolor lumbar crónico en el contexto de sospecha de celiaquía (con estudio en curso), antecedente de tratamiento por artritis reumática, mención de 'tema inmunológico', depresión y anemia ferropénica (hierro muy bajo). Estos factores sistémicos requieren un diagnóstico y manejo médico prioritario antes de cualquier intervención fisioterapéutica intensiva.",
      "action": "Derivación médica urgente para completar el estudio diagnóstico de la enfermedad sistémica (celiaquía, condición inmunológica) y manejo de la anemia y depresión. La terapia manual o el ejercicio intenso podrían estar contraindicados o requerir modificación hasta que la condición sistémica esté controlada y se tenga un diagnóstico claro. La fisioterapia debe enfocarse inicialmente en educación, manejo del dolor y movilización suave, siempre coordinada con el equipo médico."
    }
  ],
  "suggestions": [],
  "soap_quality": {
    "subjective": 70,
    "objective": 65,
    "assessment": 70,
    "plan": 70,
    "overall": 69
  },
  "soap_note": {},
  "functional_goals": [],
  "treatment_techniques": [],
  "analysis_metadata": {
    "red_flags_detected": 2,
    "risk_level": "LOW",
    "confidence": 0,
    "clinical_facts_extracted": 2,
    "processing_stages": 3
  },
  "success": true,
  "metadata": {
    "processingTime": 97.054,
    "modelUsed": "cascade-v2",
    "totalTime": 97.055,
    "timestamp": "2025-07-17T06:17:02.228Z",
    "version": "2.0-optimized"
  }
}

🔍 ANÁLISIS DE LA RESPUESTA:
   - Status HTTP: 200
   - Content-Type: application/json; charset=utf-8
   - Tamaño respuesta: 2191 caracteres
   - Warnings detectados: 2
✅ CASO EXITOSO

🏁 RESUMEN FINAL DE LA VALIDACIÓN
================================================================================
📊 Total de casos ejecutados: 2
✅ Casos exitosos: 2
❌ Casos fallidos: 0
⏱️ Tiempo total de procesamiento: 137871ms
📈 Tiempo promedio por caso: 68935.5ms
🎯 Tasa de éxito: 100.0%
================================================================================
📈 EVALUACIÓN DE RENDIMIENTO:
   🔴 CRÍTICO: Tiempo de respuesta > 10 segundos
   🟢 EXCELENTE: 100% de casos exitosos
================================================================================
🏥 PROTOCOLO DE VALIDACIÓN BACKEND COMPLETADO
